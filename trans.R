data <- read.csv("//studfiles.campus.uvt.nl/files/home/home01/u271201/Desktop/dataset-sis-energy-derived-reanalysis-4bc534fa-5f2c-4c1d-bbf7-c8e47cb8688b/H_ERA5_ECMW_T639_TA-_0002m_Euro_NUT2_S197901010000_E202309302300_INS_TIM_01d_NA-_noc_org_NA_NA---_NA---_NA---.csv", header = TRUE)
install.packages("tidyr")
library(tidyr)

# Reshape the data frame
data_long <- gather(data, key = "Region", value = "Temperature", -Date)

# Save to new CSV file
write.csv(data_long, "new_data.csv", row.names = FALSE)

#######################################################

death <- read.csv(url("https://ec.europa.eu/eurostat/api/dissemination/sdmx/3.0/data/dataflow/ESTAT/demo_r_mweek3/1.0/*.*.*.*.*?c[freq]=W&c[unit]=NR&c[sex]=T,M,F&c[age]=Y75-79,Y80-84,Y85-89,Y_GE90,Y_LT5,Y5-9,Y10-14,Y15-19,Y20-24,Y25-29,Y30-34,Y35-39,Y40-44,Y45-49,Y50-54,Y55-59,Y60-64,Y65-69,Y70-74,TOTAL&c[geo]=ES111,ES112,ES113,ES114,ES120,ES130,ES211,ES213,ES212,ES220,ES230,ES241,ES242,ES243,ES300,ES411,ES412,ES413,ES414,ES415,ES416,ES417,ES418,ES419,ES421,ES422,ES423,ES424,ES425,ES431,ES432,ES511,ES512,ES513,ES514,ES521,ES522,ES523,ES531,ES532,ES533,ES611,ES612,ES613,ES614,ES615,ES616,ES617,ES618,ES620,ES630,ES640,ES703,ES704,ES705,ES706,ES707,ES708,ES709&compress=true&format=csvdata&formatVersion=2.0&c[TIME_PERIOD]=2023-W39,2023-W38,2023-W37,2023-W36,2023-W35,2023-W34,2023-W33,2023-W32,2023-W31,2023-W30,2023-W29,2023-W28,2023-W27,2023-W26,2023-W25,2023-W24,2023-W23,2023-W22,2023-W21,2023-W20,2023-W19,2023-W18,2023-W17,2023-W16,2023-W15,2023-W14,2023-W13,2023-W12,2023-W11,2023-W10,2023-W09,2023-W08,2023-W07,2023-W06,2023-W05,2023-W04,2023-W03,2023-W02,2023-W01,2022-W52,2022-W51,2022-W50,2022-W49,2022-W48,2022-W47,2022-W46,2022-W45,2022-W44,2022-W43,2022-W42,2022-W41,2022-W40,2022-W39,2022-W38,2022-W37,2022-W36,2022-W35,2022-W34,2022-W33,2022-W32,2022-W31,2022-W30,2022-W29,2022-W28,2022-W27,2022-W26,2022-W25,2022-W24,2022-W23,2022-W22,2022-W21,2022-W20,2022-W19,2022-W18,2022-W17,2022-W16,2022-W15,2022-W14,2022-W13,2022-W12,2022-W11,2022-W10,2022-W09,2022-W08,2022-W07,2022-W06,2022-W05,2022-W04,2022-W03,2022-W02,2022-W01,2021-W99,2021-W52,2021-W51,2021-W50,2021-W49,2021-W48,2021-W47,2021-W46,2021-W45,2021-W44,2021-W43,2021-W42,2021-W41,2021-W40,2021-W39,2021-W38,2021-W37,2021-W36,2021-W35,2021-W34,2021-W33,2021-W32,2021-W31,2021-W30,2021-W29,2021-W28,2021-W27,2021-W26,2021-W25,2021-W24,2021-W23,2021-W22,2021-W21,2021-W20,2021-W19,2021-W18,2021-W17,2021-W16,2021-W15,2021-W14,2021-W13,2021-W12,2021-W11,2021-W10,2021-W09,2021-W08,2021-W07,2021-W06,2021-W05,2021-W04,2021-W03,2021-W02,2021-W01,2020-W99,2020-W53,2020-W52,2020-W51,2020-W50,2020-W49,2020-W48,2020-W47,2020-W46,2020-W45,2020-W44,2020-W43,2020-W42,2020-W41,2020-W40,2020-W39,2020-W38,2020-W37,2020-W36,2020-W35,2020-W34,2020-W33,2020-W32,2020-W31,2020-W30,2020-W29,2020-W28,2020-W27,2020-W26,2020-W25,2020-W24,2020-W23,2020-W22,2020-W21,2020-W20,2020-W19,2020-W18,2020-W17,2020-W16,2020-W15,2020-W14,2020-W13,2020-W12,2020-W11,2020-W10,2020-W09,2020-W08,2020-W07,2020-W06,2020-W05,2020-W04,2020-W03,2020-W02,2020-W01,2019-W52,2019-W51,2019-W50,2019-W49,2019-W48,2019-W47,2019-W46,2019-W45,2019-W44,2019-W43,2019-W42,2019-W41,2019-W40,2019-W39,2019-W38,2019-W37,2019-W36,2019-W35,2019-W34,2019-W33,2019-W32,2019-W31,2019-W30,2019-W29,2019-W28,2019-W27,2019-W26,2019-W25,2019-W24,2019-W23,2019-W22,2019-W21,2019-W20,2019-W19,2019-W18,2019-W17,2019-W16,2019-W15,2019-W14,2019-W13,2019-W12,2019-W11,2019-W10,2019-W09,2019-W08,2019-W07,2019-W06,2019-W05,2019-W04,2019-W03,2019-W02,2019-W01,2018-W52,2018-W51,2018-W50,2018-W49,2018-W48,2018-W47,2018-W46,2018-W45,2018-W44,2018-W43,2018-W42,2018-W41,2018-W40,2018-W39,2018-W38,2018-W37,2018-W36,2018-W35,2018-W34,2018-W33,2018-W32,2018-W31,2018-W30,2018-W29,2018-W28,2018-W27,2018-W26,2018-W25,2018-W24,2018-W23,2018-W22,2018-W21,2018-W20,2018-W19,2018-W18,2018-W17,2018-W16,2018-W15,2018-W14,2018-W13,2018-W12,2018-W11,2018-W10,2018-W09,2018-W08,2018-W07,2018-W06,2018-W05,2018-W04,2018-W03,2018-W02,2018-W01,2017-W52,2017-W51,2017-W50,2017-W49,2017-W48,2017-W47,2017-W46,2017-W45,2017-W44,2017-W43,2017-W42,2017-W41,2017-W40,2017-W39,2017-W38,2017-W37,2017-W36,2017-W35,2017-W34,2017-W33,2017-W32,2017-W31,2017-W30,2017-W29,2017-W28,2017-W27,2017-W26,2017-W25,2017-W24,2017-W23,2017-W22,2017-W21,2017-W20,2017-W19,2017-W18,2017-W17,2017-W16,2017-W15,2017-W14,2017-W13,2017-W12,2017-W11,2017-W10,2017-W09,2017-W08,2017-W07,2017-W06,2017-W05,2017-W04,2017-W03,2017-W02,2017-W01"))
install.packages("tidyr")
install.packages("eurostat")
library(remotes)
library(eurostat)
library(tidyverse)
library(rsdmx)
library(eurostat)
library(tidyr)

###############################MORTALITY########################################
# Windows file path example
path <- "C:\\Users\\u271201\\Downloads\\estat_demo_r_mweek3_filtered_en (1).csv.gz"



# read the CSV file
pop <- read.csv(path2)

# separate the TIME_PERIOD column into two columns
death1 <- separate(death, TIME_PERIOD, into = c("year", "week"), sep = "-") 


# Create new columns for NUTS
death1$NUTS1 <- ifelse(nchar(death1$geo) == 2, death1$geo, NA)
death1$NUTS2 <- ifelse(nchar(death1$geo) == 4, death1$geo, NA)
death1$NUTS3 <- ifelse(nchar(death1$geo) == 5, death1$geo, NA)

death1 <- death1[, !(names(death1) %in% c("NUTS0", "STRUCTURE","STRUCTURE_ID", "freq","unit", "OBS_FLAG "))]

############################## POPOLATION ######################################
path2 <- "C:\\Users\\u271201\\Downloads\\estat_demo_r_pjangrp3_filtered_en.csv.gz"

# read the CSV file
pop <- read.csv(path2)
names(pop)[names(pop) == "TIME_PERIOD"] <- "year"
death1$year <- as.integer(death1$year)


# Create new columns for NUTS
pop$NUTS1 <- ifelse(nchar(pop$geo) == 2, pop$geo, NA)
pop$NUTS2 <- ifelse(nchar(pop$geo) == 4, pop$geo, NA)
pop$NUTS3 <- ifelse(nchar(pop$geo) == 5, pop$geo, NA)
pop <- pop[, !(names(pop) %in% c( "STRUCTURE","STRUCTURE_ID", "freq","unit", "OBS_FLAG "))]

###############################POLLUTION##########################################

